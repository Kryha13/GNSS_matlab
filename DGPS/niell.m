function [md,mw]=niell(t0,r,el);
%el [rad]

D=[1.2769934e-3, 1.2683230e-3, 1.2465397e-3, 1.2196049e-3, 1.2045996e-3;...
   2.9153695e-3, 2.9152299e-3, 2.9288445e-3, 2.9022565e-3, 2.9024912e-3;...
   62.610505e-3, 62.837393e-3, 63.721774e-3, 63.824265e-3, 64.258455e-3;...
   0.0, 1.2709626e-5, 2.6523662e-5, 3.4000452e-5, 4.1202191e-5;...
   0.0, 2.1414979e-5, 3.0160779e-5, 7.2562722e-5, 11.723375e-5;...
   0.0, 9.0128400e-5, 4.3497037e-5, 84.795348e-5, 170.37206e-5;];

W=[5.8021897e-4, 5.6794847e-4, 5.8118019e-4, 5.9727542e-4, 6.1641693e-4;...
   1.4275268e-3, 1.5138625e-3, 1.4572752e-3, 1.5007428e-3, 1.7599082e-3;...
   4.3472961e-2, 4.6729510e-2, 4.3908931e-2, 4.4626982e-2, 5.4736038e-2;];

aht=2.53e-5; bht=5.49e-3; cht=1.14e-3;

a = 6378137;
e2 = 0.00669438002290;

[B,L,H]=hirvonen(r(1),r(2),r(3),a,e2);
h=H-34.5;

i=abs(floor((B*180/pi)/15));
T=datenum(str2num(datestr(t0,10)),1,28);


for j=1:3
    Ad(j,1)=coff(D,j,i,t0,T);
    Ad(j,2)=coff(D,j,i+1,t0,T);
    Ad(j,3)=Ad(j,1)+((B-(i*15*pi/180))*(Ad(j,2)-Ad(j,1))/(15*pi/180));
    
    Aw(j,1)=W(j,i);
    Aw(j,2)=W(j,i+1);
    Aw(j,3)=Aw(j,1)+((B-(i*15*pi/180))*(Aw(j,2)-Aw(j,1))/(15*pi/180));
end;

mh=h*((1/sin(el))-map(aht,bht,cht,el))/1000;
md=map(Ad(1,3),Ad(2,3),Ad(3,3),el)+mh;
mw=map(Aw(1,3),Aw(2,3),Aw(3,3),el);


%el[rad]
function m=map(a,b,c,el), m=(1+(a/(1+(b/(1+c)))))/(sin(el)+(a/(sin(el)+(b/(sin(el)+c)))));
function a=coff(D,k,i,t0,T), a=D(k,i)-D(k+3,i)*cos((t0-T)*2*pi/365.25);